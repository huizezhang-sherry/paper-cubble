---
title: "2-0-cube"
output: pdf_document
---

<!-- and software implementation has been seen in many R packages: \pkg{raster} [@raster], \pkg{terra} [@terra], and \pkg{stars} [@stars]. -->

<!-- # Existing work and new challenges -->

<!-- Spatio-temporal software should echo with the advance in spatial and temporal data analysis. This section will start with the \pkg{spacetime} paper [@spacetime] that sets the foundation for wrangling spatio-temporal data in \proglang{R}, and then describe some emerging concepts and software in data analysis since the paper publishes and what remains as challenges. -->


<!-- Also, array is not the best solution for a large subset of data, specifically, the vector spatio-temporal data. With vector data, spatial and temporal variables are commonly collected in separate 2D tables and there is usually a location ID to link the spatial and temporal information. Sometimes, the geometrical shape of the location may not present and an additional linking is needed to incorporate the map data. With the multiple pieces in 2D data frame format, there should be a solution to organise all these data from multiple sources in a 2D structure, without needing to convert it into higher dimensional representation. -->


# Conceptual framework: spatio-temporal cube {#cube}

Spatio-temporal data can be conceptualised using a cubical data model with three axes, typically time, latitude and longitude. This abstraction can be useful for generalising operations and visualisation purposes: @lu_multidimensional_2018 shows how array operations (select, scale, reduce, rearrange, and compute) can be mapped onto the cube; @bach_review_2014 reviews the temporal data visualisation based on space-time cube operations. Notice that the term space-time cube in their article "does not need to involve spatial data", but refers to "an abstract 2D substrate that is used to visualize data at a specific time". Despite its main focus being on temporal data, the mindset of abstracting out data representation to construct visualisation still applies to our spatio-temporal data manipulation and visualisation.

The most common data cube using the three axes (time, latitude, longitude)  could be considered as taking snapshots of the space and stacking on time. Here we will define the spatio-temporal cube slightly differently with the three axes (time, site, variable), as illustrated in Figure \ref{fig:cube-def}. The time axis is the same in both versions, while the site axis now captures both latitude and longitude. Finally, variables are stacked on this space-time canvas, with one observation per site and time point. This notion is adopted to avoid using hypercubes when describing multivariate spatio-temporal data and is the conceptual framework behind \pkg{cubble}.

While a cubical data model is neat to view the spatio-temporal data conceptually, a 3D data representation, or an array,  may not be convenient for data wrangling. There are two reasons for this: 1) While arrays are efficient for the computation on numerical values, spatio-temporal data contains more than just numerical variables. For example, wrangling on character strings and specific datetime classes is common for spatio-temporal data but may not be easily done with array objects. 2) Creating new variables in an array is more complex than in a data frame since it now needs to be defined in a 2D space, rather than a 1D vector, to be added into the array.


```{r cube-def, echo = FALSE, fig.align="center", out.width = "50%", fig.cap = "An illustration of the conceptualised spatio-temporal cube with three axes: time, site, and variable."}
knitr::include_graphics(here::here("figures/cube-def.png"))
```
